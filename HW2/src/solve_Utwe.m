# U is Upper Triangular matrix U transposedfunction [w] = solve_Utwe(U)##  % z is solution to U z = y   n = columns(U);    ek_p = 1.0;  t_p(1:n) = 0.0;  t_m(1:n) = 0.0;  tk = 1.0;  for k = 1 : n      ek_p = sign(- tk) * abs(ek_p);            if (abs(U(k, k)) < abs(ek_p - t_p(k)))        s = abs(U(k, k)) / abs(ek_p - t_p(k));        t_p(1:n) = s * t_p(1:n);        ek_p = s * ek_p;      end            ek_m = - ek_p;            if (U(k, k) ~= 0.0)        wk_p = (ek_p - tk) / U(k,k);        wk_m = (ek_m - tk) / U(k,k);      else        wk_p = 1.0;        wk_m = 1.0;      endif            t_p(k) = ek_p - tk;      t_m(k) = ek_m - tk;            for j = k+1 : n          t_p(j) += U(k,j) * wk_p;          t_m(j) += U(k,j) * wk_m;      endfor            t_p(k) = wk_p;      t_m(k) = wk_m;  endfor      w = t_p.';      if(sum(t_p) < sum(t_m))    w = t_m.';   endif  endfunction
