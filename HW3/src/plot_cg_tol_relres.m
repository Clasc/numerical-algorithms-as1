function plot_cg_tol_relres(file, precon_type)  [A, rows, cols, entries] = mmread(file);  A = sparse(A);  b = rand(rows,1);  x0 = rand(rows,1);  maxit = uint32(rows);  [M1,M2] = get_precondition(A, precon_type, rows);    tol = 1;  for i = 1:20    [~, cg_iter, cg_res_vec] = cg(A, b, tol, maxit, x0);    [~, iter, res_vec] = p_cg(A, b, tol, maxit, x0, M1, M2);    tols(i) = tol;        cg_residuals(i) = cg_res_vec(end);    cg_iterations(i) = iter;        iterations(i) = iter;    residuals(i) = res_vec(end);        tol = tol/2;    endfor    figure  semilogy(tols, residuals, tols, cg_residuals);  title("Tolerance compared to last relative residual");  xlabel("Tolerance");  ylabel("Last relative residual");  grid("on");  legend(strcat("pcg precondition:", precon_type), "cg");    figure  plot(tols, iterations, tols, cg_iterations);  title("Tolerance compared to executed iterations");  xlabel("Tolerance");  ylabel("Iterations");  grid("on");  legend(strcat("pcg precondition:", precon_type), "cg");
endfunction
